<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Proxy Monitor</title>
    <style type="text/css">
        body
        {
            font-family: Calibri, Verdana, Sans-Serif;
            font-size: smaller;
        }
        h1, h2
        {
            font-family: Cambria, Verdana, Sans-Serif;
            color: #385B86;
        }
        h1
        {
            font-size: x-large;
            width: 100%;
            border-bottom: solid #385B86 1px;
        }
        h2
        {
            font-size: medium;
            font-weight: bold;
        }
        pre, code
        {
            font-size: larger;
            background-color: #EEECE1;
        }
    </style>
</head>
<body>
    <h1>
        Proxy Monitor</h1>
    <h2>
        Introduction</h2>
    <p>
        Proxy Monitor is a small application that monitors the network and auto-detects
        the internet proxy server to use.</p>
    <p>
        <img src="Images/NotificationIcon.png" alt="Proxy Monitor Notification Icon" /></p>
    <h2>
        Installation</h2>
    <p>
        Before this application can be used, the .NET Framework Version 2.0 must be installed.
        It is included in recent versions of Windows and available for free through Windows
        Update or at <a href="http://msdn.microsoft.com/netframework/downloads/updates/default.aspx"
            target="_blank">Microsoft's download page for the .NET Framework</a>.</p>
    <p>
        The application can be installed by just copying it to a destination directory of
        your choice. Uninstalling is just a matter of deleting the files again – there are
        no registry settings or other external items that are modified by the application.</p>
    <h2>
        Usage</h2>
    <p>
        The application can be started as a regular application, which will make it run
        as an icon in the system notification area. When started, it will auto-detect the
        proxy server to use. It will also automatically re-detect the proxy server when
        the computer’s network address has changed.</p>
    <p>
        You can right-click the icon to manually set the proxy server or to trigger an auto-detection.</p>
    <p>
        <img src="Images/MenuItems.png" alt="Proxy Monitor Menu" /></p>
    <p>
        The application can also be run from the command-line with the /detect flag to auto-detect
        the proxy and exit immediately (e.g. when the computer starts up).</p>
    <h2>
        Configuration</h2>
    <p>
        The application must be configured to include the definitions of the known proxy
        servers. This involves changing the ProxyMonitor.exe.config file in a text editor
        to list all known proxy servers in the <code>&lt;proxyServers&gt;</code> element.</p>
    <p>
        Each proxy server must be represented as a <code>&lt;proxyServer&gt;</code> element
        with the following attributes:</p>
    <ul>
        <li><code>name</code>: the friendly name of the proxy server. This will show up in the
            context menu of the application icon in the notification area.</li>
        <li><code>host</code>: the IP-address or host name of the proxy server.</li>
        <li><code>port</code>: the TCP port to use on the proxy server (defaults to port 80).</li>
        <li><code>bypassForLocalAddresses</code>: set to true to bypass the proxy server for
            local addresses, or false to always use the proxy server (defaults to true).</li>
        <li><code>bypassList</code>: set to true to bypass the proxy server for local addresses,
            or false to always use the proxy server (defaults to true).</li>
        <li><code>autoConfigUrl</code>: set this to the url of an automatic proxy configuration
            script, if available.</li>
        <li><code>command</code>: the command (DOS command, batch file, ...) to execute if this
            proxy is used.</li>
        <li><code>skipAutoDetect</code>: skips auto-detection of this proxy server, so that
            it only can be set manually through the context menu.</li>
    </ul>
    <p>
        Only the <code>name</code> and either the <code>host</code> or <code>autoConfigUrl</code>
        attributes are mandatory.</p>
    <p>
        Each proxy server is in checked to see if it is available by attempting to download
        the <code>autoConfigUrl</code> or by sending a ping command to the <code>host</code>.
        When the download succeeded or a reply is received, the proxy server will be used
        and optionally the <code>command</code> is executed. If needed, the ping timeout
        value can be modified in the <code>pingTimeout</code> attribute of the <code>&lt;proxyConfiguration&gt;</code>
        element (the default is 1000 milliseconds).</p>
    <p>
        It is also possible to disable all proxy change notifications (balloon tips) by
        setting the <code>disableNotifications</code> attribute of the <code>&lt;proxyConfiguration&gt;</code>
        element to <code>true</code> (the default is <code>false</code>).
    </p>
    <p>
        A sample configuration file looks as follows:</p>
    <pre>&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;configuration&gt;
  &lt;configSections&gt;
    &lt;section name="proxyConfiguration"
      type="ProxyMonitor.Configuration.ProxyConfiguration, ProxyMonitor"/&gt;
  &lt;/configSections&gt;
  &lt;proxyConfiguration pingTimeout="1000" disableNotifications="false"&gt;
    &lt;proxyServers&gt;
      &lt;proxyServer name="Home"
        host="homeproxy"
        port="8080" 
        bypassForLocalAddresses="false"
        skipAutoDetect="false" /&gt;
      &lt;proxyServer name="Work"
        autoConfigUrl="http://workproxy/autoconfig.pac"
        bypassForLocalAddresses="true" 
        bypassList="server1;server2"
        command="ConnectToShares.bat"
        skipAutoDetect="false" /&gt;
    &lt;/proxyServers&gt;
  &lt;/proxyConfiguration&gt;
&lt;/configuration&gt;</pre>
    <h2>
        What's New?</h2>
    <h2>
        v1.2 (08/09/2008)</h2>
    <ul>
        <li>Added the <code>skipAutoDetect</code> attribute to support proxies that are only
            set manually.</li>
        <li>Fixed the bug where Interet Explorer would override the proxy settings again (at
            random) to their previous values.</li>
    </ul>
    <h2>
        v1.1.0 (11/09/2007)</h2>
    <ul>
        <li>Added the <code>bypassList</code> attribute to support the proxy bypass list.</li>
        <li>Added the <code>disableNotifications</code> attribute to allow disabling notifications
            (balloon tips).</li>
    </ul>
    <h2>
        v1.0.60905 (05/09/2006)</h2>
    <ul>
        <li>The configured proxy servers are now checked in parallel to speed up proxy detection.</li>
    </ul>
    <h2>
        v1.0.60807 (07/08/2006)</h2>
    <ul>
        <li>A custom command can now be executed when the proxy server is set.</li>
    </ul>
    <h2>
        v1.0.60805 (05/08/2006)</h2>
    <ul>
        <li>Besides pinging the <code>host</code>, the <code>autoConfigUrl</code> attribute
            of the <code>proxyServer</code> element is now used to determine if the proxy server
            is reachable by attempting a download of the configuration script.</li>
        <li>As a result, the <code>host</code> attribute of the <code>proxyServer</code> element
            is now optional.</li>
        <li>When starting the application with the /detect flag to auto-detect the proxy server
            and exit immediately, a notification is still shown to indicate which proxy server
            was set.</li>
        <li>Better exception handling.</li>
    </ul>
    <h2>
        v1.0.60802 (02/08/2006)</h2>
    <ul>
        <li>Initial Release.</li>
    </ul>
    <h2>
        License</h2>
    <pre style="font-size: small;">Microsoft Public License (Ms-PL)

This license governs use of the accompanying software. If you use the software,
you accept this license. If you do not accept the license, do not use the
software.

1. Definitions

The terms "reproduce," "reproduction," "derivative works," and "distribution"
have the same meaning here as under U.S. copyright law.

A "contribution" is the original software, or any additions or changes to the
software.

A "contributor" is any person that distributes its contribution under this
license.

"Licensed patents" are a contributor's patent claims that read directly on its
contribution.

2. Grant of Rights

(A) Copyright Grant- Subject to the terms of this license, including the
license conditions and limitations in section 3, each contributor grants
you a non-exclusive, worldwide, royalty-free copyright license to reproduce
its contribution, prepare derivative works of its contribution, and distribute
its contribution or any derivative works that you create.

(B) Patent Grant- Subject to the terms of this license, including the license
conditions and limitations in section 3, each contributor grants you a
non-exclusive, worldwide, royalty-free license under its licensed patents to
make, have made, use, sell, offer for sale, import, and/or otherwise dispose
of its contribution in the software or derivative works of the contribution in
the software.

3. Conditions and Limitations

(A) No Trademark License- This license does not grant you rights to use any
contributors' name, logo, or trademarks.

(B) If you bring a patent claim against any contributor over patents that you
claim are infringed by the software, your patent license from such contributor
to the software ends automatically.

(C) If you distribute any portion of the software, you must retain all
copyright, patent, trademark, and attribution notices that are present in
the software.

(D) If you distribute any portion of the software in source code form, you may
do so only under this license by including a complete copy of this license
with your distribution. If you distribute any portion of the software in
compiled or object code form, you may only do so under a license that complies
with this license.

(E) The software is licensed "as-is." You bear the risk of using it. The
contributors give no express warranties, guarantees or conditions. You may
have additional consumer rights under your local laws which this license cannot
change. To the extent permitted under your local laws, the contributors exclude
the implied warranties of merchantability, fitness for a particular purpose and
non-infringement.</pre>
</body>
</html>
